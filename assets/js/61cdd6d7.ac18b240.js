"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[558],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return p}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var m=a.createContext({}),s=function(e){var t=a.useContext(m),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(m.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,m=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=s(n),p=o,h=c["".concat(m,".").concat(p)]||c[p]||u[p]||r;return n?a.createElement(h,i(i({ref:t},d),{},{components:n})):a.createElement(h,i({ref:t},d))}));function p(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=c;var l={};for(var m in t)hasOwnProperty.call(t,m)&&(l[m]=t[m]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},6066:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return m},default:function(){return p},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u}});var a=n(7462),o=n(3366),r=(n(7294),n(3905)),i=["components"],l={id:"commandspy",title:"Commands.py file",sidebar_label:"Back - commands.py"},m=void 0,s={unversionedId:"commandspy",id:"commandspy",title:"Commands.py file",description:"Introduction to devices and commands",source:"@site/docs/commandspy.md",sourceDirName:".",slug:"/commandspy",permalink:"/Homeware-LAN/docs/commandspy",editUrl:"https://github.com/kikeelectronico/Homeware-LAN/tree/master/docs/docs/commandspy.md",tags:[],version:"current",frontMatter:{id:"commandspy",title:"Commands.py file",sidebar_label:"Back - commands.py"},sidebar:"someSidebar",previous:{title:"Back - data.py",permalink:"/Homeware-LAN/docs/datapy"},next:{title:"Back - homeGraph.py",permalink:"/Homeware-LAN/docs/homegraphpy"}},d={},u=[{value:"Introduction to devices and commands",id:"introduction-to-devices-and-commands",level:2},{value:"In Homeware",id:"in-homeware",level:3},{value:"Definition",id:"definition",level:4},{value:"Status",id:"status",level:4},{value:"In Google Smarthome",id:"in-google-smarthome",level:3},{value:"Processing a Google request",id:"processing-a-google-request",level:3},{value:"Attributes",id:"attributes",level:2},{value:"Device",id:"device",level:3},{value:"Params",id:"params",level:3},{value:"Auxiliar Methods",id:"auxiliar-methods",level:2},{value:"saveAndSend",id:"saveandsend",level:3},{value:"Arguments",id:"arguments",level:4},{value:"input",id:"input",level:5},{value:"output",id:"output",level:5},{value:"Returns",id:"returns",level:4},{value:"sendCommand",id:"sendcommand",level:3},{value:"Arguments",id:"arguments-1",level:4},{value:"command",id:"command",level:5},{value:"Returns",id:"returns-1",level:4},{value:"sendDobleCommand",id:"senddoblecommand",level:3},{value:"Arguments",id:"arguments-2",level:4},{value:"param",id:"param",level:5},{value:"true_command",id:"true_command",level:5},{value:"false_command",id:"false_command",level:5},{value:"Returns",id:"returns-2",level:4}],c={toc:u};function p(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"introduction-to-devices-and-commands"},"Introduction to devices and commands"),(0,r.kt)("h3",{id:"in-homeware"},"In Homeware"),(0,r.kt)("p",null,"In Homeware a device has a definition object and a status object. In example:"),(0,r.kt)("h4",{id:"definition"},"Definition"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "id": "light001",\n  "name": {\n    "defaultNames": [\n      "Lamp",\n      "My lamp"\n    ],\n    "nicknames": [\n      "Lamp",\n      "My lamp"\n    ],\n    "name": "Lamp"\n  },\n  "attributes": {\n    "commandOnlyOnOff": false,\n    "queryOnlyOnOff": false\n  },\n  "traits": [\n    "action.devices.traits.OnOff"\n  ],\n  "type": "action.devices.types.LIGHT",\n  "deviceInfo": {\n    "hwVersion": "2.0",\n    "manufacturer": "Homeware-LAN Inc.",\n    "model": "Homeware-LAN awesome lamp",\n    "swVersion": "2.0"\n  }\n}\n')),(0,r.kt)("h4",{id:"status"},"Status"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "online": true,\n  "on": false\n}\n')),(0,r.kt)("h3",{id:"in-google-smarthome"},"In Google Smarthome"),(0,r.kt)("p",null,"In Google Smarthome what a device can do its defined by its traits. For example, a ",(0,r.kt)("a",{href:"https://developers.google.com/assistant/smarthome/guides/light"},"lamp")," needs the following traits in order to work:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"action.devices.traits.OnOff")),(0,r.kt)("p",null,"And can have the following traits as optionals:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"action.devices.traits.ColorSetting"),(0,r.kt)("li",{parentName:"ul"},"action.devices.traits.Brightness")),(0,r.kt)("p",null,"Each trait has attributes, status and commands. The attributes can be seen in the Homeware's definition object. The status can be seen in the Homeware's status object and is composed by params."),(0,r.kt)("p",null,"The ",(0,r.kt)("em",{parentName:"p"},"on")," param in the lamp status indicates the lamp is turned on."),(0,r.kt)("p",null,"When a param must be changed, Google sends to Homeware a request. This request contains the params that must be updated organized in ",(0,r.kt)("em",{parentName:"p"},"commands"),". In example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "command": "action.devices.commands.OnOff",\n  "params": {\n    "on": true\n  }\n}\n')),(0,r.kt)("h3",{id:"processing-a-google-request"},"Processing a Google request"),(0,r.kt)("p",null,"Homeware process commands in different ways. Some times Homeware only updates the param in the database. Other times Homeware only sends something via MQTT to the device."),(0,r.kt)("p",null,"The class ",(0,r.kt)("em",{parentName:"p"},"Commands")," contains the methods needed to process this commands. Each command that can be received must have a processor method in the class. The method should process the data in the proper way for the command."),(0,r.kt)("p",null,"The method name is the termination of the command. In example, the command ",(0,r.kt)("em",{parentName:"p"},"action.devices.commands.OnOff")," is processed in the method ",(0,r.kt)("em",{parentName:"p"},"OnOff"),"."),(0,r.kt)("h2",{id:"attributes"},"Attributes"),(0,r.kt)("h3",{id:"device"},"Device"),(0,r.kt)("p",null,"The device on which the command should be applied can be found on the attribute ",(0,r.kt)("em",{parentName:"p"},"device")," and can be consulted using ",(0,r.kt)("inlineCode",{parentName:"p"},"self.device"),"."),(0,r.kt)("h3",{id:"params"},"Params"),(0,r.kt)("p",null,"When the commands is sent with some params like"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "command": "action.devices.commands.OnOff",\n  "params": {\n    "on": true\n  }\n}\n')),(0,r.kt)("p",null,"the params can be found on the attribute ",(0,r.kt)("em",{parentName:"p"},"params")," and can be consulted ussing ",(0,r.kt)("inlineCode",{parentName:"p"},"self.params"),"."),(0,r.kt)("h2",{id:"auxiliar-methods"},"Auxiliar Methods"),(0,r.kt)("h3",{id:"saveandsend"},"saveAndSend"),(0,r.kt)("p",null,"This method save the param received in the database and alert the device."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"myData.saveAndSend(input, output)")),(0,r.kt)("h4",{id:"arguments"},"Arguments"),(0,r.kt)("h5",{id:"input"},"input"),(0,r.kt)("p",null,"The name of the received param that want to be saved."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: string"),(0,r.kt)("li",{parentName:"ul"},"Example: 'on'")),(0,r.kt)("h5",{id:"output"},"output"),(0,r.kt)("p",null,"The name that must be used to save the param. Sometimes doesn't match with the recieved name, but normally does."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: string"),(0,r.kt)("li",{parentName:"ul"},"Example: 'on'")),(0,r.kt)("h4",{id:"returns"},"Returns"),(0,r.kt)("p",null,"None"),(0,r.kt)("h3",{id:"sendcommand"},"sendCommand"),(0,r.kt)("p",null,"This method sends a command (a text) to the device to which the Google's command should be applied."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"myData.sendCommand(command)")),(0,r.kt)("h4",{id:"arguments-1"},"Arguments"),(0,r.kt)("h5",{id:"command"},"command"),(0,r.kt)("p",null,"The command that must be send to the device. The command is sent to the MQTT topic: ",(0,r.kt)("inlineCode",{parentName:"p"},"device/<device-id>/command"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: string"),(0,r.kt)("li",{parentName:"ul"},"Example: 'cancel the'")),(0,r.kt)("h4",{id:"returns-1"},"Returns"),(0,r.kt)("p",null,"None"),(0,r.kt)("h3",{id:"senddoblecommand"},"sendDobleCommand"),(0,r.kt)("p",null,"This method sends the true_command if the param is logic true and false_command if the param is logic false."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"myData.sendDobleCommand(param, true_command, false_command)")),(0,r.kt)("h4",{id:"arguments-2"},"Arguments"),(0,r.kt)("h5",{id:"param"},"param"),(0,r.kt)("p",null,"The boolean param that want to be evaluated."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: string"),(0,r.kt)("li",{parentName:"ul"},"Example: 'on'")),(0,r.kt)("h5",{id:"true_command"},"true_command"),(0,r.kt)("p",null,"The command that must be sent to the device when the param is logic true."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: string"),(0,r.kt)("li",{parentName:"ul"},"Example: 'turn on'")),(0,r.kt)("h5",{id:"false_command"},"false_command"),(0,r.kt)("p",null,"The command that must be sent to the device when the param is logic false."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: string"),(0,r.kt)("li",{parentName:"ul"},"Example: 'turn off'")),(0,r.kt)("h4",{id:"returns-2"},"Returns"),(0,r.kt)("p",null,"None"))}p.isMDXComponent=!0}}]);